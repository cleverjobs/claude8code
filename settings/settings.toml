# Claude8Code Configuration
# ===========================
# Non-secret settings go here. This file is committed to git.
# Secrets (API keys, tokens) go in .env, NOT here!

[server]
host = "0.0.0.0"
port = 8787
debug = false
workers = 1
log_level = "info"

[claude]
default_model = "claude-opus-4-5-20251101"
max_turns = 10
permission_mode = "acceptEdits"
cwd = "workspace"  # Working directory for Claude Code extensions (.claude/skills, commands, agents)

# SDK message handling: forward | formatted | ignore
sdk_message_mode = "forward"

# Setting sources for Claude Agent SDK
setting_sources = ["user", "project", "local"]

[claude.system_prompt]
mode = "claude_code"  # claude_code | custom
# custom_prompt = "Your custom system prompt here"

[claude.tools]
# Leave empty for all tools, or specify allowed tools
allowed = []
# allowed = ["Read", "Write", "Bash", "Glob", "Grep"]

[claude.hooks]
# SDK hooks for audit logging, permission control, and rate limiting
audit_enabled = true
permission_enabled = true
rate_limit_enabled = false
rate_limit_requests_per_minute = 60
# Custom deny patterns (regex) for permission hook
# Leave empty to use default patterns (blocks rm -rf /, fork bombs, etc.)
deny_patterns = []
# Tool invocation tracking for observability (metrics + DuckDB + Loki logs)
tool_tracking_enabled = true
tool_tracking_log_parameters = true  # Log tool parameters (with redaction)
tool_tracking_redact_sensitive = true  # Redact sensitive patterns (passwords, tokens, keys)

[security]
cors_origins = ["*"]

[session]
max_sessions = 100
ttl_seconds = 3600
cleanup_interval_seconds = 60
clear_on_release = true  # Always clear context between requests (safety)

[observability]
metrics_enabled = true
access_logs_enabled = true
access_logs_path = "data/access_logs.duckdb"
# Structured logging for Loki
structured_logging_enabled = true
log_format = "json"  # "json" for Loki/production, "console" for development
